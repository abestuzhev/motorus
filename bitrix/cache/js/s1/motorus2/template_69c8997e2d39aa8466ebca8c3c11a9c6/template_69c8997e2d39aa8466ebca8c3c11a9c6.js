function loadImage(a){$(a).parent().css("background","none");$(a).show()}$(function(){$(".transform").find("input").bind("click",function(f){var g=$(f.target).parents("div.transform");if(g.size()>0){}});$(".ca-item a").click(function(){$(".ca-item a").removeClass("active");$(this).addClass("active")});$(".slide-caption").click(function(){$(this).parent().find(".slide-controls").slideToggle(function(){$(this).parent().toggleClass("slide-open")});return false});function a(){$(".catalog-all-top").css("overflow","hidden");cw=$(".catalog-all-top").width();c=$(".catalog-all-top li").length;var f=0;$(".catalog-all-top li").each(function(){f+=$(this).outerWidth()});$(".catalog-all-top li").css("margin-left",(cw-f)/c-5+"px");$(".catalog-all-top li:first-child").css("margin-left","0px")}$(".catalog-view a").click(function(){$(".catalog-all").show();$(".catalog-all").addClass("show-panel");a();return false});$(document).click(function(){if(!$(this).parents(".catalog-all").hasClass("show-panel")){$(".catalog-all").hide();$(".catalog-all").removeClass("show-panel")}});$(".filter-form.filter").submit(function(f){f.preventDefault()});var d=$('.filter .slider-range-container input[type="text"]');if(d.length){d.keyup(function(i){var k=$(this);var f=k.attr("data-range").split("|");var h=$('.filter-slider input[name="'+k.attr("name").replace(/_$/,"")+'"]');if(h.length==0){return}h=h.parent();var j=h.find(".min-range input").val();var g=h.find(".max-range input").val();h.find(".slider-range").slider({values:[j,g]});OpenAjax.hub.publish("UpdateParam",{type:"slider",name:k.attr("name").replace(/_$/,"").replace(/[^\[]+\[/,"").replace(/\]\[.+/,""),values:[j,g]})})}$(".slider-range").slider({range:true,min:1,max:30,values:[1,30],slide:function(j,k){var m=$(this).parent();var i=$(j.target);var h=i.slider("option","min");var f=i.slider("option","max");var l=k.values[0]<=h?h:k.values[0];var g=k.values[1]>=f?f:k.values[1];m.find("input.left").attr("value",l);m.find("input.right").attr("value",g);m.find(".min-range input").val(k.values[0]);m.find(".max-range input").val(k.values[1])},stop:function(g,h){var i=$(g.target).parents("div.filter-slider");var f=$(g.target).parent().find("input.left").attr("name").replace(/[^\[]+\[/,"").replace(/\]\[.+/,"");OpenAjax.hub.publish("UpdateParam",{type:"slider",name:f,values:[h.values[0],h.values[1]]})},create:function(g,l){var i=$(this).attr("data-min");var m=$(this).attr("data-max");var j=$(this).attr("data-left");var o=$(this).attr("data-right");var q=$(g.target);var h=(j<=i)?i:j;var n=(o>=m)?m:o;var f=$(g.target).parent().find("input.left").attr("name").replace(/[^\[]+\[/,"").replace(/\]\[.+/,"");q.parent().find("input.left").attr("value",h);q.parent().find("input.right").attr("value",n);q.slider("option","min",Number(i));q.slider("option","max",Number(m));q.slider("option","values",[118,300]);var k=q.parent().find(".min-range input");k.val(j);var p=q.parent().find(".max-range input");p.val(o);q.parent().find(".min-range input, .max-range input").change(function(){var r=[k.val(),p.val()];q.slider({values:r});OpenAjax.hub.publish("UpdateParam",{type:"slider",name:f,values:r})})}});$("body").bind("basket/trychange",function(i){var g=$(window).height()/2+$(document).scrollTop()-50;var f=$(".wrapper").width()/2;$("#product-alert-loading").css({top:g,left:f-150});$("#product-alert-loading").fadeIn()});$("body").bind("basket/success",function(i){var g=$(window).height()/2+$(document).scrollTop()-50;var f=$(".wrapper").width()/2;$("#product-alert-loading").fadeOut();$("#product-alert").css({top:g,left:f-150,width:"300px",height:"100px",opacity:"1"});$("#product-alert").show().delay(1500).animate({top:0,left:$(".wrapper").width()-300+"px",width:0,height:0,opacity:"0"})});$("body").bind("basket/fail",function(g){var f=$(window).height()/2+$(document).scrollTop()-50;$("#product-alert-loading").fadeOut();$("#product-alert-fail").css("top",f);$("#product-alert-fail").fadeIn().delay(800).fadeOut()});$("body").bind("loading_cursor/stop",function(f){$("#loading").css("visibility","hidden")});$("body").bind("loading_cursor/run",function(f){$("#loading").css("visibility","visible")});$("body").bind("mousemove.loading",function(f){b(f)});$("body").bind("scroll.loading",function(f){b(f)});$("body").bind("loading/finished",function(){});function e(h){h=h||window.event;if(h.pageX==null&&h.clientX!=null){var g=document.documentElement;var f=document.body;h.pageX=h.clientX+(g&&g.scrollLeft||f&&f.scrollLeft||0)-(g.clientLeft||0);h.pageY=h.clientY+(g&&g.scrollTop||f&&f.scrollTop||0)-(g.clientTop||0)}if(!h.which&&h.button){h.which=h.button&1?1:(h.button&2?3:(h.button&4?2:0))}return h}function b(f){f=e(f);var g=(window.innerWidth)?window.innerWidth:((document.all)?document.body.offsetWidth:null);if((f.pageX+70)>g){f.pageX=g-10}$("#loading").css("left",f.pageX+10);$("#loading").css("top",f.pageY-20)}$("dl.tabs dt").click(function(){$(this).siblings().removeClass("selected").end().next("dd").andSelf().addClass("selected")})});$(function(){$(".spares-breadcrumbs-list-item > a").each(function(){$(this).click(function(){$(".spares-breadcrumbs-list-item").removeClass("active");$(this).parent().toggleClass("active");return false})});$(document).click(function(){$(".spares-breadcrumbs-list-item").removeClass("active")})});$(document).ready(function(){$(".callback-popup-city select").styler();$(".city-fancybox").fancybox({wrapCSS:"city-fancybox"});$(".header-links li.phone a").on("click",function(a){a.preventDefault();$(this).parents(".header-links li.phone").addClass("open")});$(".city-popup ul a").on("click",function(b){b.preventDefault();var d=$(this).text();var a=$(this).data("phone");$.post("/ajax/save-city.php",{city:d,phone:a});$("#site-city").html(d);$("#site-phone").html(a);$.fancybox.close()});$(".callback-popup-close").on("click",function(a){a.preventDefault();$(this).parents(".header-links li.phone").removeClass("open")});$(".-form-validate").each(function(){$(this).validate({invalidHandler:function(){setTimeout(function(){$(".-form-validate input, .-form-validate select").trigger("refresh")},1)},errorPlacement:function(a,b){}})});$(".callback-popup-city select").on("change",function(){var a=$(this);setTimeout(function(){a.trigger("refresh")},1)});$(".-form-submit").each(function(){$(this).addClass("-form-submit-active");$(this).on("submit",function(h){h.preventDefault();var i=false;if($(this).hasClass("-form-validate")&&!$(this).valid()){i=true}if(!i){var a=$(this),g=a.attr("action"),f=new FormData(this),d=BX.bitrix_sessid();f.append("iblock",a.data("iblock"));f.append("sessid",d);a.find('input[type="submit"]').prop("disabled",true);var b=$.ajax({url:g,type:"POST",data:f,processData:false,contentType:false});b.done(function(){var e=$.parseJSON(b.responseText);a.hide();var j="-form-error";if(e.result==true){j="-form-success"}a.parent().find(".-form-response").addClass(j).show("fast",function(){$(this).html(e.message)})});b.fail(function(){alert(statusText)});b.always(function(){a.find('input[type="submit"]').removeAttr("disabled")})}})})});var closePopupTimer;var popupTimerValue=5;function declination(e,d,i,g){var h=[e,d,i];var f=g%100;if(f>=11&&f<=14){f=0}else{f=(f%=10)<5?(f>2?2:f):0}return(h[f])}function updatePopup(){popupTimerValue--;if(popupTimerValue>0){var a=popupTimerValue+" "+declination("секунд","секунду","секунды",popupTimerValue);$("#basket-popup #popup-time").text(a)}else{$.fancybox.close(true);popupTimerValue=5;clearTimeout(closePopupTimer)}}function basket_event(b,f,g){b.preventDefault();if(g==="form-element"){var j="/catalog/add2basket.php?"+$(f).parent().serialize();var i=$(f).parents(".product-details");var e=$(".catalog-item-image input").val();var h=$(".catalog-item-title").text()}else{if(g==="form-list"){var j="/catalog/add2basket.php?"+$(f).parent().serialize();var a=$(f).parent().parent().parent().parent().parent();var e=a.find(".item-image input").val();var h=a.find(".item-title a").text()}else{if(g==="form-required"){var j="/catalog/add2basket.php?"+$(f).parent().serialize(),d=$(f).data("id"),h=$(".dont-forget-list").find(".item").filter("[data-id="+d+"]").data().title,e=$(f).data("img")}}}$.fancybox.showLoading();$.ajax({url:j,dataType:"json",success:function(k){if(k.status=="ok"){$("#basket-popup #popup-time").text("5 секунд");$("#basket-popup .basket-popup-picture img").attr("src",e);$("#basket-popup .basket-popup-title span").text(h);$.fancybox($("#basket-popup"),{padding:23,scrolling:"no",afterLoad:function(){closePopupTimer=setInterval(updatePopup,1000);$("#basket-popup .close-popup").click(function(){$.fancybox.close(true);return false})},afterClose:function(){clearTimeout(closePopupTimer)}});$("body").trigger("basket/success");$("body").trigger("basket/add",k)}else{$.fancybox('<div class="message-popup-container"><div class="popup-caption">Ошибка</div><div class="message-popup-container">Ошибка добавления товара в корзину.</div></div>',{padding:23,scrolling:"no"});$("body").trigger("basket/fail");$("body").trigger("basket/add",k)}}});return false}function AddToBasket(a){var b=$(a).parents("form").serialize();b+="&action=ADD2BASKET";$.fancybox.showLoading();$.post("/ajax/cart.ajax.php",b,function(e){if(e){var f=$(a).attr("data-name");var d=$(a).attr("data-picture");$("#basket-popup #popup-time").text("5 секунд");$("#basket-popup .basket-popup-picture img").attr("src",d);$("#basket-popup .basket-popup-title span").text(f);$.fancybox($("#basket-popup"),{padding:23,scrolling:"no",afterLoad:function(){closePopupTimer=setInterval(updatePopup,1000);$("#basket-popup .close-popup").click(function(){$.fancybox.close(true);return false})},afterClose:function(){clearTimeout(closePopupTimer)}});$("body").trigger("basket/success");$("body").trigger("basket/add",e)}else{$.fancybox('<div class="message-popup-container"><div class="popup-caption">Ошибка</div><div class="message-popup-container">Ошибка добавления товара в корзину.</div></div>',{padding:23,scrolling:"no"});$("body").trigger("basket/fail");$("body").trigger("basket/add",e)}});return false}$(function(){$('.catalog-item-to-cart form [type="submit"]').click(function(a){basket_event(a,this,"form-element")});$(document).on("click",'.item-box .item-buy form [type="submit"]',function(a){basket_event(a,this,"form-list")});$('.catalog-item-analog-list .item form [type="submit"]').click(function(a){basket_event(a,this,"form-list")});$('.dont-forget-list .item-buy form [type="submit"]').click(function(a){basket_event(a,this,"form-required")})});$(function(){$("body").bind("basket/add",function(a){updateSmallBasket()});$("body").bind("basket/remove",function(a){updateSmallBasket()})});function updateSmallBasket(){$.get("/ajax/sale.basket.basket.small.php",function(a){$("#small-basket").html(a)})}(function(a){a.fn.extend({customSelect:function(b){if(!a.browser.msie||(a.browser.msie&&a.browser.version>6)){var d={customClass:null};var b=a.extend(d,b);return this.each(function(){var e=a(this).find(":selected");var g=e.html()||"&nbsp;";var j=a('<span class="customSelectInner" />').append(g);var i=a('<span class="customSelect" />').append(j);if(b.customClass){i.addClass(b.customClass)}a(this).after(i);var h=parseInt(a(this).outerWidth())-(parseInt(i.outerWidth())-parseInt(i.width()));i.css({display:"inline-block"});j.css({width:h,display:"inline-block"});var f=i.outerHeight();a(this).css({"-webkit-appearance":"menulist-button",width:i.outerWidth(),position:"absolute",opacity:0,height:f,fontSize:a(this).next().css("font-size")}).change(function(){j.text(a(this).find(":selected").text()).parent().addClass("customSelectChanged");setTimeout(function(){i.removeClass("customSelectOpen")},60)}).bind("mousedown",function(){i.toggleClass("customSelectOpen")}).focus(function(){i.addClass("customSelectFocus")}).blur(function(){i.removeClass("customSelectFocus customSelectOpen")})})}}})})(jQuery);