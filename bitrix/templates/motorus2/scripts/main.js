$(document).ready(function(){$(".catalog-category-display a").click(function(s){s.preventDefault();var n=$(this).parent(),t="display-"+n.data("display");n.addClass("active").siblings().removeClass("active");$(".catalog-category-list").removeClass("display-grid").removeClass("display-line").addClass(t)});$(".catalog-item-thumbs-list").slick({dots:false,slidesToShow:4,slidesToScroll:1});$("#catalog-category-sort-dd a").click(function(n){$(".catalog-category-sort > a").text($(this).text());$(".catalog-category-sort > a").attr("href",$(this).attr("href"))});function o(n){return $("html").hasClass(n)}function k(){console.log();h=$("html");if($(this).width()<1280){h.addClass("min-width")}else{h.removeClass("min-width")}}$(window).resize(function(){k()});k();if(o("generatedcontent")==false||o("ie8")==true){$(".before").prepend('<div class="before"></div>')}else{$(".before").removeClass("before")}if(o("generatedcontent")==false||o("ie7")==true){$(".after").append('<div class="after"></div>')}else{$(".after").removeClass("after")}$(".filter .button-open").click(function(){var s=$(this);var n=$(this).parent().find("div.text");n.slideToggle(300,function(){s.toggleClass("open")});return false});$("form.classic .text").each(function(){$(this).wrap('<div class="input-text"></div>')});$("form.classic textarea").each(function(){$(this).wrap('<div class="textarea"></div>')});$("form.classic select").customSelect();$(".cart-list input.quantity").each(function(n,s){$(s).spinner({min:1,max:99999})});function d(t){t=t||window.event;if(t.pageX==null&&t.clientX!=null){var s=document.documentElement;var n=document.body;t.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s.clientLeft||0);t.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s.clientTop||0)}if(!t.which&&t.button){t.which=t.button&1?1:(t.button&2?3:(t.button&4?2:0))}return t}function q(n){n=d(n);var s=(window.innerWidth)?window.innerWidth:((document.all)?document.body.offsetWidth:null);if((n.pageX+70)>s){n.pageX=s-10}$("#loading").css("left",n.pageX+10);$("#loading").css("top",n.pageY-10)}$("body").bind("loading_cursor/stop",function(n){$("#loading").css("visibility","hidden")});$("body").bind("loading_cursor/run",function(n){$("#loading").css("visibility","visible")});$("body").bind("mousemove.loading",function(n){q(n)});$("body").bind("scroll.loading",function(n){q(n)});var j=700;var b=1;$("#slider .slider-list .slider-item").each(function(){if(b==1){$("#slider .slider-nav").append('<li class="selected"><a href="#">'+b+"</a></li>")}else{$("#slider .slider-nav").append('<li><a href="#">'+b+"</a></li>")}b++});var p=1;var i=false;var l=$("#slider .slider-left");var e=$("#slider .slider-right");var a=$("#slider .slider-nav");var r=$("#slider .slider-list .slider-item");function g(n){n.find(".left-section").stop().animate({left:0,opacity:1},j);n.find(".right-section").stop().animate({right:0,opacity:1},j);n.find(".preview-picture").stop().fadeIn(j)}function f(n,s){n.find(".left-section").stop().animate({left:-400,opacity:0},j);n.find(".right-section").stop().animate({right:-400,opacity:0},j);n.find(".preview-picture").stop().fadeOut(j,function(){s()})}function c(u,n){var t=a.find("li.selected");var s=$("#slider .slider-list").find("div.active");var v=$("#slider .slider-list .slider-item:eq("+u+")");i=true;f(s,function(){s.removeClass("active");v.addClass("active");g(v);i=false});p=u+1;t.removeClass("selected");n.parent().addClass("selected")}function m(t){var s=a.find("li.selected");var n=$("#slider .slider-list").find("div.active");if(t=="left"){if(i==false){i=true;if(p>1){f(n,function(){n.removeClass("active");n.prev().addClass("active");g(n.prev());i=false});s.removeClass("selected");s.prev().addClass("selected");p--}else{f(n,function(){n.removeClass("active");r.last().addClass("active");g(r.last());i=false});s.removeClass("selected");a.find("li:last").addClass("selected");p=r.length}}}if(t=="right"){if(i==false){i=true;if(p<r.length){f(n,function(){n.removeClass("active");n.next().addClass("active");g(n.next());i=false});s.removeClass("selected");s.next().addClass("selected");p++}else{f(n,function(){n.removeClass("active");r.first().addClass("active");g(r.first());i=false});s.removeClass("selected");a.find("li:first").addClass("selected");p=1}}}}$("#slider .slider-list .slider-item:first-child").addClass("active");g($("#slider .slider-list .active"));$("#slider-nav a").click(function(){var n=parseInt($(this).html())-1;c(n,$(this));return false});l.click(function(){m("left");return false});e.click(function(){m("right");return false});$(".fancy-box-popup").fancybox({padding:23,scrolling:"no"});$(".popup-tab-content .tab-content-tabs li a").live("click",function(){panel=$(this).attr("href");$(".tab-content-tabs li").removeClass("selected");$(".tab-content-panel").removeClass("show");$(panel).addClass("show");$(this).parent().addClass("selected");return false});$("#call-back, .call-back-link").fancybox({padding:23,scrolling:"no",type:"ajax",href:"/ajax/call_popup.php?fancybox=true",onUpdate:function(){$("#callback-form").submit(function(){$.ajax({type:"POST",url:"/ajax/call_popup.php?fancybox=true",data:{sessid:$(this).find("#sessid").val(),"PROPERTY[NAME][0]":$(this).find("#name").val(),"PROPERTY[1996][0]":$(this).find("#phone").val(),iblock_submit:"Отправить"},error:function(n){console.log(n);alert("Ошибка соединения")},success:function(n){$("#call-inner").html(n);$.fancybox.update()}});return false})}});$("#one-click-form").submit(function(){if($(this).find("#phone").val()){$.ajax({type:"POST",url:"/ajax/call_popup.php?fancybox=true",data:{sessid:$(this).find("#sessid").val(),"PROPERTY[NAME][0]":"Заказ в 1 клик","PROPERTY[1996][0]":$(this).find("#phone").val(),"PROPERTY[4099][0]":$(this).find("#order").val(),"PROPERTY[4100][0]":$(this).find("#order-link").val(),iblock_submit:"Отправить"},error:function(s){console.log(s);alert("Ошибка соединения")},success:function(t){var s=$('<div id="call-inner" />');s.html(t).find(".popup-caption").text("Заказ в 1 клик");$.fancybox.open(s)}})}else{var n=$('<div id="call-inner"><div id="call-popup" class="call-popup-container ajax-popup"><div class="popup-caption">Заказ в 1 клик</div><div class="popup-errors">Введите ваш номер телефона.</div></div></div>');$.fancybox.open(n)}return false});$("#auth-login").fancybox({padding:23,scrolling:"no",type:"ajax",href:"/ajax/auth_popup.php?fancybox=true",onUpdate:function(){$("#auth-form").submit(function(){$.ajax({type:"POST",url:"/ajax/auth.php",data:{login:$(this).find("#login").val(),password:$(this).find("#password").val()},error:function(n){console.log(n);alert("Ошибка соединения")},success:function(n){if(n=="success"){location.reload(true)}else{$("#auth-inner .popup-errors").remove();$("#auth-inner").prepend(n)}}});return false});$("#reg-form").submit(function(){$.ajax({type:"POST",url:"/ajax/reg.php",data:{login:$(this).find("#login").val()},error:function(n){console.log(n);alert("Ошибка соединения")},success:function(n){$("#reg-inner .popup-errors").remove();$("#reg-inner").prepend(n);if($("#reg-inner").find(".popup-success").length>0){$("#auth-popup .tab-content-tabs ul li:first-child").remove();$.fancybox.reposition()}}});return false})},beforeClose:function(){if($("#reg-inner").find(".popup-success").length>0){location.reload(true)}}});$(".mini-popup").click(function(){var s=$(this).attr("href");var u=$(this).offset();var t=u.top+34;var n=u.left-$(s).innerWidth()+$(this).innerWidth()+25;$(s).css({top:t,left:n});$(s).show();$(".overlay-mini-popup").show();$(".overlay-mini-popup").height($(document).height());return false});$(".overlay-mini-popup").click(function(){$(".box-mini-popup").hide();$(".overlay-mini-popup").hide()});$(window).resize(function(){$(".box-mini-popup").hide();$(".overlay-mini-popup").hide()});$("#reg-mini-form").submit(function(){$.ajax({type:"POST",url:"/ajax/reg.php",data:{login:$(this).find("#login").val()},error:function(n){console.log(n);alert("Ошибка соединения")},success:function(n){$("#reg-mini-inner .popup-errors").remove();$("#reg-mini-inner").prepend(n);if($("#reg-mini-inner").find(".popup-success").length>0){$("#auth-popup .tab-content-tabs ul li:first-child").remove();$(".box-mini-popup").hide();$(".overlay-mini-popup").hide();$.fancybox('<div class="message-popup-container"><div class="popup-caption">Регистрация</div>'+n+"</div>",{padding:23,scrolling:"no",beforeClose:function(){location.reload(true)}})}}});return false});if($(".right-sidebar").children(":visible").length==0){$(".right-sidebar").css("display","none")}$(".right-sidebar > div:last-child").addClass("no-margin");$(".spares-table").on("click",".-spares-order-button",function(v){v.preventDefault();var t=$(this).data(),w="<span>#NAME#</span>".replace(/#NAME#/g,t.name),n=$(".-order-spare-popup"),s=$(".-spares-title").text(),u=$(this).siblings().find("input").val();if(t.name.length){n.find(".-spare-input").val(t.name);n.find(".-spare-link").val(t.link);n.find(".-spare-node").val(s);n.find(".-spare-artnumber").val(t.artnumber);n.find(".-quantity-input").val(u);n.find(".-quantity").text(u);if(t.link.length){w='<a href="#LINK#">#NAME#</a>'.replace(/#NAME#/g,t.name).replace(/#LINK#/g,t.link)}n.find(".-spare-title").html(w);$.fancybox(n)}});$('form[name="SIMPLE_FORM_1"]').on("submit",function(u){u.preventDefault();var t=$(".-spare-phone"),v=$(".-spare-email"),z=$.trim(t.val()),A=$.trim(v.val()),B=function(D){$(".-spares-result").text(D).css("visibility","visible")},x=function(){$(".-spares-result").text("").css("visibility","hidden")},s=function(){$(this).off(".err");x()};if(!z&&!A){v.focus().add(t).on("click.err",s);B("Необходимо заполнить e-mail или телефон");return false}if(A&&!/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/i.test(A)){v.focus().on("click.err",s);B("Проверьте правильность заполнения полей");return false}if(z&&(z.length<4||!/^[\d\(\) \-\+]+$/.test(z))){t.focus().on("click.err",s);B("Проверьте правильность заполнения полей");return false}$.fancybox.showLoading();$(".-order-spare-popup").find(".spares-order-button").prop("disabled",true);var C=$(this),w=C.prop("action"),n=new FormData(this);n.append("sessid",window.BX.message.bitrix_sessid);var y=$.ajax({url:w,type:"POST",data:n,contentType:false,processData:false}).done(function(D){B("Заявка успешно отправлена");setTimeout(function(){x();$.fancybox.close();$(".-spare-email").val("");$(".-spare-phone").val("");$(".-order-spare-popup").find(".spares-order-button").prop("disabled",false)},2000)}).fail(function(D,E){alert(E)}).always(function(){$.fancybox.hideLoading()})})});function openPopupMessage(){var c=$("#error-messages-popup");var a="Ошибка регистрации нового пользователя: Пользователь с таким e-mail (danco@primepix.ru) уже существует.";var b='<p>Ошибка регистрации нового пользователя: Пользователь с таким e-mail (danco@primepix.ru) уже существует.</p><p>Вы можете воспользоваться <a href="/users/" id="popup-auth-login">формой авторизации</a> для входа на сайт.</p>';if((c.length>0)&&(!c.hasClass("on-show"))){if(c.text().trim()==a){c.html(b)}c.prepend('<div class="popup-caption">Ошибка</div>');$.fancybox.open("#error-messages-popup",{maxWidth:350,minWidth:350,beforeShow:function(){c.addClass("on-show");$("#popup-auth-login").click(function(){$("#auth-login").click();return false})}})}}setInterval(openPopupMessage,1000);$(document).ready(function(){if($(".cat-button").length){var a=$(".cat-list").height(),c=370,b=true;$(".cat-list").css("height",c);$(".cat-button").click(function(){if(b){$(".cat-list").animate({height:a},function(){$(".cat-button a span").text("свернуть");$(".cat-button").removeClass("collapsed").addClass("expanded");b=false})}else{$(".cat-list").animate({height:c},function(){$(".cat-button a span").text("еще категории");$(".cat-button").removeClass("expanded").addClass("collapsed");b=true})}return false})}});$(function(){$.throttle=jq_throttle=function(c,d,i,g){var f,b=0;if(typeof d!=="boolean"){g=i;i=d;d=undefined}function e(){var n=this,l=+new Date()-b,m=arguments;function k(){b=+new Date();i.apply(n,m)}function j(){f=undefined}if(g&&!f){k()}f&&clearTimeout(f);if(g===undefined&&l>c){k()}else{if(d!==true){f=setTimeout(g?j:k,g===undefined?c-l:c)}}}if($.guid){e.guid=i.guid=i.guid||$.guid++}return e};var a=$(".top-button-wrapper").find("a").on("click",function(b){b.preventDefault();$("html,body").animate({scrollTop:0})});$(window).on("scroll resize",$.throttle(250,function(){var b=$(document).scrollTop(),d=$(".content-container"),c=$(window).width()-d.offset().left-d.width()+70;a.css("right",c);if(b>300){a.show()}else{a.hide()}})).trigger("resize")});